<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ENVS543 Narratives - 15&nbsp; Contingency Analysisq</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./correlation.html" rel="next">
<link href="./statistical_inferences.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./discrete_data.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Contingency Analysisq</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">ENVS543 Narratives</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./welcome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Environmental Data Literacy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analysis_environment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The R Environment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Markdown</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Quarto</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Git &amp; GitHub</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Basic Data Types</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_containers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Basic Data Containers in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./factors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Factor Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classic_graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Basic Graphics in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ggplot_graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title"><code>ggplot2</code> Graphics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Tidyverse</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./joins.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Joins</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistical_inferences.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Statistical Inferences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discrete_data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Contingency Analysisq</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Corelation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#discrete-data" id="toc-discrete-data" class="nav-link active" data-scroll-target="#discrete-data"><span class="header-section-number">15.1</span> Discrete Data</a>
  <ul class="collapse">
  <li><a href="#ordering-factors" id="toc-ordering-factors" class="nav-link" data-scroll-target="#ordering-factors"><span class="header-section-number">15.1.1</span> Ordering Factors</a></li>
  <li><a href="#exclusivity-of-factor-levels" id="toc-exclusivity-of-factor-levels" class="nav-link" data-scroll-target="#exclusivity-of-factor-levels"><span class="header-section-number">15.1.2</span> Exclusivity of Factor Levels</a></li>
  </ul></li>
  <li><a href="#the-forcats-library" id="toc-the-forcats-library" class="nav-link" data-scroll-target="#the-forcats-library"><span class="header-section-number">15.2</span> The <code>forcats</code> Library</a></li>
  <li><a href="#using-factors" id="toc-using-factors" class="nav-link" data-scroll-target="#using-factors"><span class="header-section-number">15.3</span> Using Factors</a>
  <ul class="collapse">
  <li><a href="#by-the-by" id="toc-by-the-by" class="nav-link" data-scroll-target="#by-the-by"><span class="header-section-number">15.3.1</span> By the by</a></li>
  <li><a href="#missing-data" id="toc-missing-data" class="nav-link" data-scroll-target="#missing-data"><span class="header-section-number">15.3.2</span> Missing Data</a></li>
  </ul></li>
  <li><a href="#univariate-data" id="toc-univariate-data" class="nav-link" data-scroll-target="#univariate-data"><span class="header-section-number">15.4</span> Univariate Data</a>
  <ul class="collapse">
  <li><a href="#the-binomial" id="toc-the-binomial" class="nav-link" data-scroll-target="#the-binomial"><span class="header-section-number">15.4.1</span> The Binomial</a></li>
  <li><a href="#the-multinomial" id="toc-the-multinomial" class="nav-link" data-scroll-target="#the-multinomial"><span class="header-section-number">15.4.2</span> The Multinomial</a></li>
  </ul></li>
  <li><a href="#contingency-tables" id="toc-contingency-tables" class="nav-link" data-scroll-target="#contingency-tables"><span class="header-section-number">15.5</span> Contingency Tables</a>
  <ul class="collapse">
  <li><a href="#rows-columns" id="toc-rows-columns" class="nav-link" data-scroll-target="#rows-columns"><span class="header-section-number">15.5.1</span> Rows &amp; Columns</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Contingency Analysisq</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In this section, we are going to take a short dive into the kinds of analyses you would consider if you had discrete predictor and response data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>( <span class="fu">library</span>( tidyverse ) )</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>( ggrepel )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="discrete-data" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="discrete-data"><span class="header-section-number">15.1</span> Discrete Data</h2>
<blockquote class="blockquote">
<p>Factors allow us to represent a type of data that exclusive and categorical. These data may, or may not, be ordered and in most cases, we can think of these kinds of data to represent things like, treatment levels, sampling locations, etc.</p>
</blockquote>
<p>While we’ve seen this already, perhaps we hadn’t know how it was working under the hood, so I’m going to start by using days of the week—generated by hand and not from the <code>lubridate</code> library as they are a good example of a data type that is <em>discrete</em> and <em>exclusive</em> (e.g., you cannot be in both Monday and Wednesday at the same time).</p>
<p>In <code>R</code>, character data can be turned into a new data type called a <code>Factor</code> making it something that in statistical analyses we can use to represent things like <em>treatment</em> levels. Initially, they start as a character data type.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>weekdays <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Monday"</span>,<span class="st">"Tuesday"</span>,<span class="st">"Wednesday"</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Thursday"</span>,<span class="st">"Friday"</span>,<span class="st">"Saturday"</span>, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Sunday"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>( weekdays )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
<p>Let’s assume I have sampled a random set of days (40 days in this case) as a data set I’ll use an example. In <code>R</code>, I’m just going to use the <code>sample()</code> function (to grab with replacement)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">sample</span>( weekdays, <span class="at">size=</span><span class="dv">40</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Sunday"    "Thursday"  "Wednesday" "Wednesday" "Monday"    "Wednesday"
 [7] "Friday"    "Wednesday" "Saturday"  "Wednesday" "Saturday"  "Thursday" 
[13] "Thursday"  "Sunday"    "Sunday"    "Sunday"    "Saturday"  "Monday"   
[19] "Monday"    "Wednesday" "Saturday"  "Sunday"    "Wednesday" "Thursday" 
[25] "Tuesday"   "Saturday"  "Wednesday" "Friday"    "Thursday"  "Sunday"   
[31] "Wednesday" "Monday"    "Saturday"  "Thursday"  "Wednesday" "Wednesday"
[37] "Tuesday"   "Thursday"  "Thursday"  "Wednesday"</code></pre>
</div>
</div>
<p>These data are still</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>( data )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
<p>If I’d like to turn them into a factor, we use… <code>factor()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>days <span class="ot">&lt;-</span> <span class="fu">factor</span>( data )</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.factor</span>( days )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>( days )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
</div>
<p>Now when we look at the data, it looks a lot like it did before <em>except for the last line</em> which shows you the unique levels for elements in the vector.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( days )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Friday    Monday  Saturday    Sunday  Thursday   Tuesday Wednesday 
        2         4         6         6         8         2        12 </code></pre>
</div>
</div>
<p>We can put them into data frames and they know how to summarize themselves properly by counting the number of occurances of each level.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>, <span class="at">Weekdays =</span> days )</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( df )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ID             Weekdays 
 Min.   : 1.00   Friday   : 2  
 1st Qu.:10.75   Monday   : 4  
 Median :20.50   Saturday : 6  
 Mean   :20.50   Sunday   : 6  
 3rd Qu.:30.25   Thursday : 8  
 Max.   :40.00   Tuesday  : 2  
                 Wednesday:12  </code></pre>
</div>
</div>
<p>And we can directly access the unique levels within a factor as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>( days )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Friday"    "Monday"    "Saturday"  "Sunday"    "Thursday"  "Tuesday"  
[7] "Wednesday"</code></pre>
</div>
</div>
<p>So factors can be categorical (e.g., one is just different than the next) and compared via <code>==</code> and <code>!=</code> values. They can also be ordinal such that <code>&gt;</code> and <code>&lt;</code> make sense.</p>
<p>By default, a <code>factor</code> is not ordered <strong>unless we specify it to be so</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.ordered</span>( days )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>days[<span class="dv">1</span>] <span class="sc">&lt;</span> days[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in Ops.factor(days[1], days[2]): '&lt;' not meaningful for factors</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">factor</span>( days, <span class="at">ordered=</span><span class="cn">TRUE</span> )</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>data </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Sunday    Thursday  Wednesday Wednesday Monday    Wednesday Friday   
 [8] Wednesday Saturday  Wednesday Saturday  Thursday  Thursday  Sunday   
[15] Sunday    Sunday    Saturday  Monday    Monday    Wednesday Saturday 
[22] Sunday    Wednesday Thursday  Tuesday   Saturday  Wednesday Friday   
[29] Thursday  Sunday    Wednesday Monday    Saturday  Thursday  Wednesday
[36] Wednesday Tuesday   Thursday  Thursday  Wednesday
7 Levels: Friday &lt; Monday &lt; Saturday &lt; Sunday &lt; Thursday &lt; ... &lt; Wednesday</code></pre>
</div>
</div>
<p>So that if we go and try to order them, the only way they can be sorted is alphabetically (which is what <code>R</code> does internally when we run a <code>summary()</code> on the weekday stuff, it presentes the level counts in alphabetical order).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>( data )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Friday    Friday    Monday    Monday    Monday    Monday    Saturday 
 [8] Saturday  Saturday  Saturday  Saturday  Saturday  Sunday    Sunday   
[15] Sunday    Sunday    Sunday    Sunday    Thursday  Thursday  Thursday 
[22] Thursday  Thursday  Thursday  Thursday  Thursday  Tuesday   Tuesday  
[29] Wednesday Wednesday Wednesday Wednesday Wednesday Wednesday Wednesday
[36] Wednesday Wednesday Wednesday Wednesday Wednesday
7 Levels: Friday &lt; Monday &lt; Saturday &lt; Sunday &lt; Thursday &lt; ... &lt; Wednesday</code></pre>
</div>
</div>
<p>However, this does not make sense. Who in their right mind would like to have <code>Friday</code> followed immediately by <code>Monday</code>? That is just not right!</p>
<section id="ordering-factors" class="level3" data-number="15.1.1">
<h3 data-number="15.1.1" class="anchored" data-anchor-id="ordering-factors"><span class="header-section-number">15.1.1</span> Ordering Factors</h3>
<p>To establish an ordinal variable with a specified sequence of values that are <em>not alphabetical</em> we need to pass along the levels themselves as well as an indication that the data are supposed to be <code>ordered</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">factor</span>( days, <span class="at">ordered=</span><span class="cn">TRUE</span>, <span class="at">levels =</span> weekdays )</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Sunday    Thursday  Wednesday Wednesday Monday    Wednesday Friday   
 [8] Wednesday Saturday  Wednesday Saturday  Thursday  Thursday  Sunday   
[15] Sunday    Sunday    Saturday  Monday    Monday    Wednesday Saturday 
[22] Sunday    Wednesday Thursday  Tuesday   Saturday  Wednesday Friday   
[29] Thursday  Sunday    Wednesday Monday    Saturday  Thursday  Wednesday
[36] Wednesday Tuesday   Thursday  Thursday  Wednesday
7 Levels: Monday &lt; Tuesday &lt; Wednesday &lt; Thursday &lt; Friday &lt; ... &lt; Sunday</code></pre>
</div>
</div>
<p>Now they’ll sort properly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>( data )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Monday    Monday    Monday    Monday    Tuesday   Tuesday   Wednesday
 [8] Wednesday Wednesday Wednesday Wednesday Wednesday Wednesday Wednesday
[15] Wednesday Wednesday Wednesday Wednesday Thursday  Thursday  Thursday 
[22] Thursday  Thursday  Thursday  Thursday  Thursday  Friday    Friday   
[29] Saturday  Saturday  Saturday  Saturday  Saturday  Saturday  Sunday   
[36] Sunday    Sunday    Sunday    Sunday    Sunday   
7 Levels: Monday &lt; Tuesday &lt; Wednesday &lt; Thursday &lt; Friday &lt; ... &lt; Sunday</code></pre>
</div>
</div>
<p>Notice one important thing here. The arrangement of the values in the vector <code>weekdays</code> that we give it is the <em>de facto</em> ordering that is imposed. For example, if you were to reverse the <code>weekday</code> vector, it would ordinate the results in the opposite fashion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">factor</span>( days, <span class="at">ordered =</span> <span class="cn">TRUE</span>, <span class="at">levels =</span> <span class="fu">rev</span>(weekdays )) <span class="ot">-&gt;</span> bkwrds</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( bkwrds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sunday  Saturday    Friday  Thursday Wednesday   Tuesday    Monday 
        6         6         2         8        12         2         4 </code></pre>
</div>
</div>
<p>So be <em>very explicit</em> when you define these.</p>
</section>
<section id="exclusivity-of-factor-levels" class="level3" data-number="15.1.2">
<h3 data-number="15.1.2" class="anchored" data-anchor-id="exclusivity-of-factor-levels"><span class="header-section-number">15.1.2</span> Exclusivity of Factor Levels</h3>
<p>Once you establish a factor, you cannot set the values to anyting that is outside of the pre-defined levels. If you do, it will just put in missing data <code>NA</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>days[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">"Bob"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in `[&lt;-.factor`(`*tmp*`, 3, value = "Bob"): invalid factor level, NA
generated</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>days</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Sunday    Thursday  &lt;NA&gt;      Wednesday Monday    Wednesday Friday   
 [8] Wednesday Saturday  Wednesday Saturday  Thursday  Thursday  Sunday   
[15] Sunday    Sunday    Saturday  Monday    Monday    Wednesday Saturday 
[22] Sunday    Wednesday Thursday  Tuesday   Saturday  Wednesday Friday   
[29] Thursday  Sunday    Wednesday Monday    Saturday  Thursday  Wednesday
[36] Wednesday Tuesday   Thursday  Thursday  Wednesday
Levels: Friday Monday Saturday Sunday Thursday Tuesday Wednesday</code></pre>
</div>
</div>
<p>That being said, we can have more levels in the factor than observed in the data. Here is an example of just grabbing the work days from the week but making the levels equal to all the potential weekdays.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>workdays <span class="ot">&lt;-</span> <span class="fu">sample</span>( weekdays[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="at">size=</span><span class="dv">40</span>, <span class="at">replace =</span> <span class="cn">TRUE</span> )</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>workdays <span class="ot">&lt;-</span> <span class="fu">factor</span>( workdays, <span class="at">ordered=</span><span class="cn">TRUE</span>, <span class="at">levels =</span> weekdays )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And when we summarize it, we see that while it is possible that days may be named <code>Saturday</code> and <code>Sunday</code>, they are not recoreded in the data we have for workdays.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( workdays )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Monday   Tuesday Wednesday  Thursday    Friday  Saturday    Sunday 
       15         4         7        10         4         0         0 </code></pre>
</div>
</div>
<p>We can drop the levels that have no representation in the sample (this is helpful if you are making output or subsequent analyses based upon subsets of the data and do not want to consider the levels you have zero observations for).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>workdays <span class="ot">&lt;-</span> <span class="fu">droplevels</span>( workdays ) </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( workdays )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Monday   Tuesday Wednesday  Thursday    Friday 
       15         4         7        10         4 </code></pre>
</div>
</div>
</section>
</section>
<section id="the-forcats-library" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="the-forcats-library"><span class="header-section-number">15.2</span> The <code>forcats</code> Library</h2>
<p>The <code>forcats</code> library has a bunch of helper functions for working with factors. This is a relatively small library in <code>tidyverse</code> but a powerful one. I would recommend looking at the <a href="http://www.flutterbys.com.au/stats/downloads/slides/figure/factors.pdf">cheatsheet</a> for it to get a more broad understanding of what functions in this library can do. In what follows, I’m just going to give you a taste of some of the functionality with a few examples of when it may be helpful.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>( forcats )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Just like <code>stringr</code> had the <code>str_</code> prefix, all the functions here have the <code>fct_</code> prefix. Here are some examples.</p>
<p><em>Counting how many of each factor</em></p>
<p>OK, this is realy just a way to get a <code>data.frame</code> output from a <code>summary()</code> like analysis… But helpful.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fct_count</span>( data )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
  f             n
  &lt;ord&gt;     &lt;int&gt;
1 Monday        4
2 Tuesday       2
3 Wednesday    12
4 Thursday      8
5 Friday        2
6 Saturday      6
7 Sunday        6</code></pre>
</div>
</div>
<p><em>Lumping Rare Factors</em></p>
<p>There are times when you only have a few observations of some levels and would need to lump these together so that you can get enough samples to make sense. By default, it combines the lowest frequency ones into an <code>Other</code> category.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>lumped <span class="ot">&lt;-</span> <span class="fu">fct_lump_min</span>( data, <span class="at">min =</span> <span class="dv">5</span> )</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fct_count</span>( lumped )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  f             n
  &lt;ord&gt;     &lt;int&gt;
1 Wednesday    12
2 Thursday      8
3 Saturday      6
4 Sunday        6
5 Other         8</code></pre>
</div>
</div>
<p><em>Reordering Factor Levels by Frequency</em></p>
<p>This reorders the factors by the frequency of observation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>freq <span class="ot">&lt;-</span> <span class="fu">fct_infreq</span>( data )</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>( freq )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Wednesday" "Thursday"  "Saturday"  "Sunday"    "Monday"    "Tuesday"  
[7] "Friday"   </code></pre>
</div>
</div>
<p><em>Reordering by Order of Appearance</em>’</p>
<p>This one reorders the factors by the order in which they are encountered in the dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>ordered <span class="ot">&lt;-</span> <span class="fu">fct_inorder</span>( data )</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>( ordered )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sunday"    "Thursday"  "Wednesday" "Monday"    "Friday"    "Saturday" 
[7] "Tuesday"  </code></pre>
</div>
</div>
<p><em>Reordering Specific Levels</em></p>
<p>This allows you to reorder specific elements by passing it the ones you want to extract and they will be put in the first position. The example I use here is that in my own calendar, I prefer the layout of <code>Monday</code> in the first position and the weekends at the end of the week. Howver, it is also common to have the week start on <code>Sunday</code> and that can be done using the <code>fct_relevel()</code> and telling it that the first one is <code>Sunday</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"    "Saturday" 
[7] "Sunday"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>newWeek <span class="ot">&lt;-</span> <span class="fu">fct_relevel</span>( data, <span class="st">"Sunday"</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>( newWeek )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sunday"    "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"   
[7] "Saturday" </code></pre>
</div>
</div>
<p><em>Dropping Unobserved Levels</em></p>
<p>This is just like <code>droplevels()</code> <strong>and</strong> there are literally 2 fewer keystrokes int he name…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>dropped <span class="ot">&lt;-</span> <span class="fu">fct_drop</span>( workdays )</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( dropped )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Monday   Tuesday Wednesday  Thursday    Friday 
       15         4         7        10         4 </code></pre>
</div>
</div>
</section>
<section id="using-factors" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="using-factors"><span class="header-section-number">15.3</span> Using Factors</h2>
<p>It is common to use factors as an organizing princple in our data. For example, let’s say we went out and sampled three different species of plants and measured characteristics of their flower size. The <code>iris</code> data set from R.A. Fisher is a classic data set that is include in <code>R</code> and it looks like this (the functions <code>head()</code> and <code>tail()</code> show the top or bottom parts of a data frame).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa</code></pre>
</div>
</div>
<p>By default it is a <code>data.frame</code> object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>( iris )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data.frame"</code></pre>
</div>
</div>
<section id="by-the-by" class="level3" data-number="15.3.1">
<h3 data-number="15.3.1" class="anchored" data-anchor-id="by-the-by"><span class="header-section-number">15.3.1</span> By the by</h3>
<p>One helpful function in base <code>R</code> is the <code>by()</code> function. It has the following form.</p>
<pre><code>by( data, index, function)</code></pre>
<p>The <code>data</code> is the raw data you are using, the <code>index</code> is a vector that we are using to differentiate among the species (the factor), and the function is what function we want to use. In Tidyverse, this is really similar to the <code>group_by() %&gt;% summarize()</code> pattern of analysis that we’ve used thus far. I include it here because you’ll probably see it in other code examples (or via AI) and should at least be familiar with it. I prefer the <code>group_by() |&gt; summarize()</code> approach myself but it is a free country…</p>
<p>So for example, if I were interested in the mean length of the Sepal for each species, I could write.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>meanSepalLength <span class="ot">&lt;-</span> <span class="fu">by</span>( iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Species, mean )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And this would:</p>
<ol type="1">
<li>Take the sepal length<br>
</li>
<li>Group it <code>by</code> Species<br>
</li>
<li>Apply the <code>mean</code> function to it.</li>
</ol>
<p>And give you the output as a specific kind of output. It is a data types that is <code>by</code> which is just a kind of fancy list-like object (like analyses outputs are).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>( meanSepalLength )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "by"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>( meanSepalLength ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "setosa"     "versicolor" "virginica" </code></pre>
</div>
</div>
<p>And the output of the data look like this</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>meanSepalLength</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>iris$Species: setosa
[1] 5.006
------------------------------------------------------------ 
iris$Species: versicolor
[1] 5.936
------------------------------------------------------------ 
iris$Species: virginica
[1] 6.588</code></pre>
</div>
</div>
<p>I could also do the same thing with the variance in sepal length (here using the square bracket notation instead of the $ one).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>( iris[,<span class="dv">2</span>], iris[,<span class="dv">5</span>], var ) <span class="ot">-&gt;</span> varSepalLength</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>varSepalLength </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>iris[, 5]: setosa
[1] 0.1436898
------------------------------------------------------------ 
iris[, 5]: versicolor
[1] 0.09846939
------------------------------------------------------------ 
iris[, 5]: virginica
[1] 0.1040041</code></pre>
</div>
</div>
<p>And then if I were doing something fancy with it, I could make it into a data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>( <span class="at">Species =</span> <span class="fu">levels</span>( iris<span class="sc">$</span>Species), </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">Average =</span> meanSepalLength,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">Variance =</span> varSepalLength</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  Species    Average  Variance  
  &lt;chr&gt;      &lt;by[1d]&gt; &lt;by[1d]&gt;  
1 setosa     5.006    0.14368980
2 versicolor 5.936    0.09846939
3 virginica  6.588    0.10400408</code></pre>
</div>
</div>
<p>Using normal tidyverse approaches, we could get the same output a bit easier as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>( Species ) <span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>( <span class="at">Average =</span> <span class="fu">mean</span>(Sepal.Length), </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">Variance =</span> <span class="fu">var</span>( Sepal.Length ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  Species    Average Variance
  &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;
1 setosa        5.01    0.124
2 versicolor    5.94    0.266
3 virginica     6.59    0.404</code></pre>
</div>
</div>
<p>But if you like the <code>by()</code> appraoch, go for it!</p>
</section>
<section id="missing-data" class="level3" data-number="15.3.2">
<h3 data-number="15.3.2" class="anchored" data-anchor-id="missing-data"><span class="header-section-number">15.3.2</span> Missing Data</h3>
<p>Missing data is a <font color="red">fact of life</font> and <code>R</code> is very opinionated about how it handles missing values. In general, missing data is encoded as <code>NA</code> and is a valid entry for any data type (character, numeric, logical, factor, etc.). Where this becomes tricky is when we are doing operations on data that has missing values. <code>R</code> could take two routes:</p>
<ol type="1">
<li>It could ignore the data and give you the answer directly as if the data were not missing, or<br>
</li>
<li>It could let you know that there is missing data and make you do something about it.</li>
</ol>
<p>Fortunately, <code>R</code> took the second route.</p>
<p>An example from the iris data, I’m going to add some missing data to it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>missingIris <span class="ot">&lt;-</span> iris[, <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>missingIris<span class="sc">$</span>Petal.Width[ <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">12</span>) ] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( missingIris )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Petal.Width          Species  
 Min.   :0.100   setosa    :50  
 1st Qu.:0.300   versicolor:50  
 Median :1.300   virginica :50  
 Mean   :1.218                  
 3rd Qu.:1.800                  
 Max.   :2.500                  
 NA's   :3                      </code></pre>
</div>
</div>
<p>Notice how the missing data is denoted in the summary.</p>
<section id="indications-of-missing-data" class="level4" data-number="15.3.2.1">
<h4 data-number="15.3.2.1" class="anchored" data-anchor-id="indications-of-missing-data"><span class="header-section-number">15.3.2.1</span> Indications of Missing Data</h4>
<p>When we perform a mathematical or statistical operation on data that has missing elements <code>R</code> will <strong>always</strong> return <code>NA</code> as the result.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>( missingIris<span class="sc">$</span>Petal.Width )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<p>This warns you that <em>at least one</em> of the observations in the data is missing.</p>
<p>Same output for using <code>by()</code>, it will put <code>NA</code> into each level that has at least one missing value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>( missingIris<span class="sc">$</span>Petal.Width, missingIris<span class="sc">$</span>Species, mean )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>missingIris$Species: setosa
[1] NA
------------------------------------------------------------ 
missingIris$Species: versicolor
[1] 1.326
------------------------------------------------------------ 
missingIris$Species: virginica
[1] 2.026</code></pre>
</div>
</div>
</section>
<section id="working-with-missing-data" class="level4" data-number="15.3.2.2">
<h4 data-number="15.3.2.2" class="anchored" data-anchor-id="working-with-missing-data"><span class="header-section-number">15.3.2.2</span> Working with Missing Data</h4>
<p>To acknowledge that there are missing data and you still want the values, you need to tell the function you are using that data is missing and you are OK with that using the optional argument <code>na.rm=TRUE</code> (<code>na</code> = missing data &amp; <code>rm</code> is <em>remove</em>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>( missingIris<span class="sc">$</span>Petal.Width, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.218367</code></pre>
</div>
</div>
<p>To pass this to the <code>by()</code> function, we add the optional argument <code>na.rm=TRUE</code> and <code>by()</code> passes it along to the <code>mean</code> function as “…”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>( missingIris<span class="sc">$</span>Petal.Width, missingIris<span class="sc">$</span>Species, mean, <span class="at">na.rm=</span><span class="cn">TRUE</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>missingIris$Species: setosa
[1] 0.2446809
------------------------------------------------------------ 
missingIris$Species: versicolor
[1] 1.326
------------------------------------------------------------ 
missingIris$Species: virginica
[1] 2.026</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="univariate-data" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="univariate-data"><span class="header-section-number">15.4</span> Univariate Data</h2>
<p>So the simplest kind of discrete data we may have will consist of just a vector of observations. These observations are factors and we can summarize the number of occuance of each type. In some sense, there is no predictor here, just a set of discrete responses. For data like this, I’m just going to demonstrate a simple binomial test example, drawing on the awesome catfish examples from the previous lecture and then introduce a quick extension of it as a Multinomial. I’m not going to spend much time on it so we can jump right into a more generalized approach using contingency tables that can be applied to both univariate data like the fish example as well as more complicated data sets with actual discrete predictors <em>and</em> responses.</p>
<section id="the-binomial" class="level3" data-number="15.4.1">
<h3 data-number="15.4.1" class="anchored" data-anchor-id="the-binomial"><span class="header-section-number">15.4.1</span> The Binomial</h3>
<p>OK, now that we understand a little about factors, we can start doing some kinds of analyses. In the previous lecture, we discussed the Binomial as a generative model for data that has two discrete states using both Catfish/Non-Catfish as a data set as well as sex ratios in the desert beetle data set.</p>
<p>For the binomial, the probability of observing <span class="math inline">\(K\)</span> items in a collection of <span class="math inline">\(N\)</span> samples (where <span class="math inline">\(N &gt; K\)</span> of course) is given as:</p>
<p><span class="math display">\[
P(K|N,p) = \frac{N!}{K!(N-K!)}p^K(1-p)^{N-K}
\]</span></p>
<p>assuming that the likelihood of observing a single instance of <span class="math inline">\(K\)</span> is given by the probability <span class="math inline">\(p\)</span> (and not <span class="math inline">\(K\)</span> is <span class="math inline">\(1-p\)</span>). While this is the probability function associated with the binomial distribution, we also have a similar statistical test of the data under the binomial.</p>
<p>To apply a binomial test, we are essentially testing the hypothesis <span class="math inline">\(H_O: p = \hat{p}\)</span>, that is that the hypothesized <span class="math inline">\(p\)</span> is equal to the specified value.</p>
<p>From the catfish example, remember that we found an estimate of <span class="math inline">\(p\)</span> to be roughly <span class="math inline">\(0.74\)</span>. If we were to go out and do another sampling session and this time, from a sample of 50 fish, get the following (made up but relevant data)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>fish_sample</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Catfish Other   Other   Catfish Catfish Catfish Catfish Catfish Other  
[10] Catfish Other   Catfish Catfish Other   Other   Other   Catfish Catfish
[19] Catfish Catfish Catfish Catfish Catfish Catfish Other   Catfish Catfish
[28] Catfish Other   Catfish Catfish Catfish Other   Other   Catfish Catfish
[37] Catfish Other   Catfish Catfish Catfish Catfish Catfish Catfish Other  
[46] Other   Other   Catfish Other   Other  
Levels: Catfish Other</code></pre>
</div>
</div>
<p>Which summarizes to:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fct_count</span>( fish_sample)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  f           n
  &lt;fct&gt;   &lt;int&gt;
1 Catfish    33
2 Other      17</code></pre>
</div>
</div>
<p>We could test the hypothesis that <em>The frequency of catfish in this sampling effort is not significantly different our previously observed frequency of 74%</em>.</p>
<p>Formally, we would specify.</p>
<p><span class="math inline">\(H_O: p = 0.74\)</span></p>
<p>and test it against the alternative hypothesis</p>
<p><span class="math inline">\(H_A: p \ne 0.74\)</span></p>
<p>In <code>R</code>, we do the statistical test by designating the number of observations in for catfish, total sample size, and the associated probability using the <code>binom.test</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">binom.test</span>(<span class="at">x =</span> <span class="dv">33</span>, <span class="at">n =</span> <span class="dv">50</span> , <span class="at">p =</span> <span class="fl">0.74</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The test returns a results object that I assigned to the variable <code>fit</code> (which is a list like object as you remember). However, we can print it out and it displays all the relevant information.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact binomial test

data:  33 and 50
number of successes = 33, number of trials = 50, p-value = 0.1991
alternative hypothesis: true probability of success is not equal to 0.74
95 percent confidence interval:
 0.5123475 0.7879453
sample estimates:
probability of success 
                  0.66 </code></pre>
</div>
</div>
<p>From this, we can see the following components:</p>
<ol type="1">
<li>The data consist of 33 catfish from a sample of size 50 (double check with data to make sure you didn’t make a typo…),</li>
<li>The Probability associated with observing 33/50 if <code>TRUE</code> frequency is <span class="math inline">\(0.74\)</span>,</li>
<li>A 95% confidence interval on the probability itself,</li>
<li>The original frequency of success in the new data.</li>
</ol>
<p>From these data, we can conclude that the likelihood of observing 33/50 as catfish is about 20% of the time. This is not so rare that we should reject the null hypothesis (unless you think 20% is a rare occurance). So we <strong>fail to reject</strong> the null <span class="math inline">\(H_O: p = 0.74\)</span>.</p>
</section>
<section id="the-multinomial" class="level3" data-number="15.4.2">
<h3 data-number="15.4.2" class="anchored" data-anchor-id="the-multinomial"><span class="header-section-number">15.4.2</span> The Multinomial</h3>
<p>The multinomial test is a simple extension of to the Binomial, when there are more than two discrete states (e.g., 3 or more). The data still have to be discrete factors (and unordered). The associated probability function is a bit messier. However, for <span class="math inline">\(K\)</span> different categories of things (each level denoted as <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>, , <span class="math inline">\(X_K\)</span>), which are expected to occur at indiviudual frequencies of <span class="math inline">\(p_1\)</span>, <span class="math inline">\(p_2\)</span>, , <span class="math inline">\(p_K\)</span> and that all the probabilities sum to one (e.g., <span class="math inline">\(\sum_{i=1}^K p_i = 1.0\)</span> ) the multinomial expansion:</p>
<p><span class="math display">\[
P(X_1 = p_1, X_2 = p_2, \ldots, X_K = p_k|N) = \frac{N!}{\prod_{i=1}^{K}x_i!}\prod_{i=1}^Kp^{x_i}
\]</span></p>
<p>We are not going to really play around with this expansion much as it requires a bunch of additional assumptions and sometimes it is just easier to run it as a contingency table analysis (in the next section). I’m just going to leave this here for prosperity sake.</p>
</section>
</section>
<section id="contingency-tables" class="level2" data-number="15.5">
<h2 data-number="15.5" class="anchored" data-anchor-id="contingency-tables"><span class="header-section-number">15.5</span> Contingency Tables</h2>
<p>This is a much more commonly used approach for when we have either univariate data or have predicted and response variables that are both discrete categorical data. Just like in the binomial multinomial examples, we can use a contingency table analysis to determine if the proportions of observations in each category are the same. Let’s assume, using the data we collected in the catfish where we found 37 catfish in a sample of 50 fishes.</p>
<p>Instead of just talking about the probability of catfish, lets talk about the probability of both catfish and not catfish as a short vector of individual probabilities.</p>
<p><span class="math display">\[
p = \left( \frac{37}{50}, \frac{13}{50} \right)  = (0.74,0.26)
\]</span></p>
<p>Now, if we go out and sample 172 fish, we would expect to see <span class="math inline">\(0.74*172=127.28\)</span> catfish and <span class="math inline">\(0.26*172=44.72\)</span> non-catfish. This is our <strong>EXPECTED</strong> values for each catgory and can be denoted as:</p>
<p><span class="math display">\[
E = [E_1, E_2]
\]</span></p>
<p>If we had <span class="math inline">\(K\)</span> different species of fishes, it could similarily be expanded to something like:</p>
<p><span class="math display">\[
E = [E_1, E_2, \ldots, E_K]
\]</span></p>
<p>with each entry being the total number of observations times the expected frequency of it.</p>
<p>Now, let’s say that we did go out and of those 172, the <strong>OBSERVED</strong> number of catfish and non-catfish were:</p>
<p><span class="math display">\[
O = [108, 64]
\]</span></p>
<p>Is the fraction of observations in the observed set distributed as expected given the proportions in the expectation? The NULL hypothesis for this test is that the probability of fish is catfish is equal to the expected fraction of catfish (or more stodgely as:)</p>
<p><span class="math inline">\(H_O: P(X\;in\;j) = p_j\)</span></p>
<p>The test statistic then becomes a measure of how close the values in <span class="math inline">\(O\)</span> are to those in <span class="math inline">\(E\)</span> (with a standardization by the magnitude of the expectation).</p>
<p><span class="math display">\[
T = \sum_{i=1}^c \frac{(O_i - E_i)^2}{E_i}
\]</span></p>
<p>This <span class="math inline">\(T\)</span> test statistic just happens to be distributed (with sufficient sample sizes) like the <span class="math inline">\(\chi^2\)</span> distribution.</p>
<p>In <code>R</code>, we can us the <code>chisq.test()</code> function. If you go take a look at the help file <code>?chisq.test</code> file for it, it shows the function as:</p>
<pre><code>chisq.test(x, y = NULL, correct = TRUE,
           p = rep(1/length(x), length(x)), rescale.p = FALSE,
           simulate.p.value = FALSE, B = 2000)</code></pre>
<p>The salient points are:</p>
<ol type="1">
<li>The value of <span class="math inline">\(x\)</span>, which is our observed data as a vector of counts.<br>
</li>
<li>The expected freqeuncies (the <span class="math inline">\(p_i\)</span> values). If you look at he function above, if you do not specify values for <span class="math inline">\(p\)</span> it will assume the categories are expected in equal proportions (e.g., <span class="math inline">\(p_1 = p_2 = \ldots = p_k\)</span>). This is not what we want, so we’ll have to supply those expected proportions to the function directly.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>Fishes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">108</span>,<span class="dv">64</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.74</span>, <span class="fl">0.26</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(<span class="at">x=</span>Fishes, <span class="at">p =</span> p )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function returns the result as a ‘list-like’ object which we can look at by printing it out.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  Fishes
X-squared = 11.233, df = 1, p-value = 0.0008037</code></pre>
</div>
</div>
<p>Given the results, the P-value is quite small. This suggests that the likelihood of the condition stated in the NULL hypothesis (e.g., that the observed counts of fish are coincident with those given by <span class="math inline">\(p\)</span>) is unlikely. In this case, we would reject the null hypothesis.</p>
<p>This approach can be generalized to any arbitrary number of categories using the same rationale and code. So if we were sampling catfish, gizzard shad, and crappy, we’d have vectors with 3 elements in them instead of just two.</p>
<section id="rows-columns" class="level3" data-number="15.5.1">
<h3 data-number="15.5.1" class="anchored" data-anchor-id="rows-columns"><span class="header-section-number">15.5.1</span> Rows &amp; Columns</h3>
<p>In general, we have two set of data here (I sometimes call them predictor and response but they can also be just two categories of data that have discrete types). I’m going to use some built-in data with hair and eye colors in <code>R</code> that was sampled from the University of Delaware in 1974 (hey, just like the motor trends data, it must have been a classic year for data sets to be put in stats packages…).</p>
<p>By default, the data are split by reported sex. The raw data look like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>HairEyeColor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>, , Sex = Male

       Eye
Hair    Brown Blue Hazel Green
  Black    32   11    10     3
  Brown    53   50    25    15
  Red      10   10     7     7
  Blond     3   30     5     8

, , Sex = Female

       Eye
Hair    Brown Blue Hazel Green
  Black    36    9     5     2
  Brown    66   34    29    14
  Red      16    7     7     7
  Blond     4   64     5     8</code></pre>
</div>
</div>
<p>I’m going to combine them together into a single data set. They are both as matrices and kept as a 3-dimensional matrix so I’m just going to add the two matrices together (rows and columns in each) as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>hairAndEye <span class="ot">&lt;-</span> HairEyeColor[,,<span class="dv">1</span>] <span class="sc">+</span> HairEyeColor[,,<span class="dv">2</span>]</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>hairAndEye</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Eye
Hair    Brown Blue Hazel Green
  Black    68   20    15     5
  Brown   119   84    54    29
  Red      26   17    14    14
  Blond     7   94    10    16</code></pre>
</div>
</div>
<p>The rationale for the underlying statatical test is that the two traits are independent. This means that:</p>
<ol type="1">
<li>Each row can be considered a random sample of eye colors from the background population that is independent of the hair color.</li>
<li>Each column of the data should be a random sample of hair colors from the background population which is independent of the eye color.</li>
</ol>
<p>Taking eye color as an example, this would assume that for a single row of the data, say the black hair row, the data look like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>hairAndEye[<span class="dv">1</span>,] <span class="ot">-&gt;</span> x</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Brown  Blue Hazel Green 
   68    20    15     5 </code></pre>
</div>
</div>
<p>The proportions of individuals in each eye color in this hair category are given as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">/</span> <span class="fu">sum</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Brown      Blue     Hazel     Green 
0.6296296 0.1851852 0.1388889 0.0462963 </code></pre>
</div>
</div>
<p>And if hair and eye color are truly independent of each other then we should expect that these proportions should roughly be equal to that if we look at the eye colors for all rows (there is a <code>rowSums</code> and <code>colSums</code> function that does just what you think it should do). In this case, if individuals in the first row of the data are from the same population as everyone else, then the total counts in the data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>( hairAndEye ) <span class="ot">-&gt;</span> tot</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>tot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Brown  Blue Hazel Green 
  220   215    93    64 </code></pre>
</div>
</div>
<p>should have roughly the same set of proportions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>tot <span class="sc">/</span> <span class="fu">sum</span>(tot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Brown      Blue     Hazel     Green 
0.3716216 0.3631757 0.1570946 0.1081081 </code></pre>
</div>
</div>
<p>Let’s plot these to take a look. If they are the same then they should fall on the line starting at the origin with a slope of 1.0.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>( <span class="at">Color =</span> <span class="fu">c</span>(<span class="st">"Brown"</span>,<span class="st">"Blue"</span>,<span class="st">"Hazel"</span>,<span class="st">"Green"</span>),</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">Total =</span> tot<span class="sc">/</span><span class="fu">sum</span>(tot),</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">Row1 =</span> x<span class="sc">/</span><span class="fu">sum</span>(x) ) <span class="sc">%&gt;%</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(Total,Row1) ) <span class="sc">+</span> </span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">intercept=</span><span class="dv">0</span>,<span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_label_repel</span>( <span class="fu">aes</span>(<span class="at">label=</span>Color) ) <span class="sc">+</span>   </span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Fraction from Total Population"</span>) <span class="sc">+</span> </span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Fraction from Row 1"</span>) <span class="sc">+</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="discrete_data_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Some are off a bit. But across all hair colors, we could do the same thing and ask the same question.</p>
<p>Let’s take the general case where the data look like this:</p>
<p><span class="math display">\[
\begin{bmatrix}
O_{11} &amp; O_{12} &amp; \ldots &amp; O_{1c} \\
O_{21} &amp; O_{22} &amp; \ldots &amp; \vdots \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
O_{r1} &amp; O_{r2} &amp; \ldots &amp; O_{rc}
\end{bmatrix}
\]</span></p>
<p>Whose rows can be summed to produce the row totals</p>
<p><span class="math display">\[
\begin{bmatrix}
R_{1} \\
R_{2} \\
\vdots \\
R_{r}
\end{bmatrix}
\]</span></p>
<p>And the columns can be summed to produce the column totals</p>
<p><span class="math display">\[
\begin{bmatrix}
C_{1} &amp; C_{2} &amp; \ldots &amp; C_{c}
\end{bmatrix}
\]</span></p>
<p>Both of which sum to <span class="math inline">\(N\)</span>, the number of total observations across all rows and columns. To simplify this whole thing a bit, let’s just talk about the independence of a student having a specific hair and eye color. The strict hypothesis we are testing here in a contingency table analysis is thus (in a very stuffy fashion):</p>
<p><span class="math inline">\(H_O:\)</span> The event ‘an observation in row i’ is independent of the event ‘the same observation in column j’ for all i and j.</p>
<p>Or if we want to shorten it</p>
<p><span class="math inline">\(H_O:\)</span> Hair and eye colors are independent traits.</p>
<p>The test statistic here depends upon the observed and expected values for each of the levels in the table. The observed data are from the table above and we can represent the count of individuals with black hair and brown eyes <span class="math inline">\(O_{black,brown} = 68\)</span>. The expected number of individuals with black hair and brown eyes is estimated as the number of individuals with black hair times the number of individuals with brown eyes divided by the total number of individuals.</p>
<p><span class="math display">\[
E_{i,j} = R_i * C_j / N
\]</span></p>
<p>We define the test statistic as the the square of the differences in observed and expected <span class="math inline">\((O_{ij} - E_{ij})^2\)</span>, standardized by the expectation (<span class="math inline">\(E_{ij}\)</span> as the fraction of the expected values). Summed across all row and columns, we get the statistic.</p>
<p><span class="math display">\[
T = \sum_{i=1}^r\sum_{j=1}^c\frac{(O_{ij} - E_{ij})^2}{E_{ij}}
\]</span></p>
<p>Now, if <span class="math inline">\(T\)</span> is small then this suggests that the observed values in each row/column combination were relatively close to what was expected (favoring the NULL hypothesis) and if <span class="math inline">\(T\)</span> is large, they the observed values are relatively far away from the expectations (favoring us to reject the NULL). How big is “big enough” depends upon the number of categories in the rows and columns… the degrees of freedom.</p>
<p><span class="math inline">\(df = (r-1)(c-1)\)</span></p>
<p>As it turns out, the <span class="math inline">\(T\)</span> statistic is an observation that is derived from the <span class="math inline">\(\chi^2\)</span> distribution with <span class="math inline">\((r-1)(c-1)\)</span> degrees of freedom. That was fun, no?</p>
<p>As it turns out, in R, once we have the raw data in a matrix format like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>hairAndEye</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Eye
Hair    Brown Blue Hazel Green
  Black    68   20    15     5
  Brown   119   84    54    29
  Red      26   17    14    14
  Blond     7   94    10    16</code></pre>
</div>
</div>
<p>To test it using a <span class="math inline">\(\chi^2\)</span>-test for independence (also called a ‘goodness of fit’ test) we just use the single function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(hairAndEye)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>which produces a result that is very ‘list-like’</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  hairAndEye
X-squared = 138.29, df = 9, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p>And from this, we have the statistic, the degrees of freedom, and the p-value associated with it. In this case, the null hypothesis as above is most likely quite uncommon as the P-value is denoted in scientific notation (moving the decimal place over to the left 16 times no less!).</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./statistical_inferences.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Statistical Inferences</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./correlation.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Corelation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>