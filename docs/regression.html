<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ENVS543 Narratives - 17&nbsp; Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./anova.html" rel="next">
<link href="./correlation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./regression.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Regression</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">ENVS543 Narratives</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./welcome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Environmental Data Literacy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analysis_environment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The R Environment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Markdown</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Quarto</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Git &amp; GitHub</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Basic Data Types</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_containers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Basic Data Containers in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./factors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Factor Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classic_graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Basic Graphics in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ggplot_graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title"><code>ggplot2</code> Graphics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Tidyverse</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./joins.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Joins</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistical_inferences.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Statistical Inferences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discrete_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Contingency Analysisq</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Corelation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#least-squares-fitting" id="toc-least-squares-fitting" class="nav-link active" data-scroll-target="#least-squares-fitting"><span class="header-section-number">17.1</span> Least Squares Fitting</a></li>
  <li><a href="#our-friend-lm" id="toc-our-friend-lm" class="nav-link" data-scroll-target="#our-friend-lm"><span class="header-section-number">17.2</span> Our Friend <code>lm()</code></a></li>
  <li><a href="#model-fit" id="toc-model-fit" class="nav-link" data-scroll-target="#model-fit"><span class="header-section-number">17.3</span> Model Fit</a></li>
  <li><a href="#analysis-of-variance-tables---decomposing-variation" id="toc-analysis-of-variance-tables---decomposing-variation" class="nav-link" data-scroll-target="#analysis-of-variance-tables---decomposing-variation"><span class="header-section-number">17.4</span> Analysis of Variance Tables - Decomposing Variation</a></li>
  <li><a href="#variance-explained" id="toc-variance-explained" class="nav-link" data-scroll-target="#variance-explained"><span class="header-section-number">17.5</span> Variance Explained</a></li>
  <li><a href="#extensions-of-the-model" id="toc-extensions-of-the-model" class="nav-link" data-scroll-target="#extensions-of-the-model"><span class="header-section-number">17.6</span> Extensions of the Model</a></li>
  <li><a href="#comparing-models" id="toc-comparing-models" class="nav-link" data-scroll-target="#comparing-models"><span class="header-section-number">17.7</span> Comparing Models</a>
  <ul class="collapse">
  <li><a href="#effects-of-adding-parameters" id="toc-effects-of-adding-parameters" class="nav-link" data-scroll-target="#effects-of-adding-parameters"><span class="header-section-number">17.7.1</span> Effects of Adding Parameters</a></li>
  </ul></li>
  <li><a href="#model-fitting" id="toc-model-fitting" class="nav-link" data-scroll-target="#model-fitting"><span class="header-section-number">17.8</span> Model Fitting</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Regression</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<blockquote class="blockquote">
<p>The overall goal of any model is to provide a low-level description of patterns within the data.</p>
</blockquote>
<p>If we think of all the variation in a data set, we can partition it into the following components:</p>
<p><span class="math display">\[
\sigma_{Total}^2 = \sigma_{Model}^2 + \sigma_{Residual}^2
\]</span></p>
<p>In that some of the underlying variation goes towards explaining the patterns in the data and the rest of the variation is <em>residual</em> (or left over). For regression analyses, consider the simple linear regression model.</p>
<p><span class="math display">\[
y_{ij} = \beta_0 + \beta_1 x_{i} + \epsilon_j
\]</span></p>
<p>Where th terms <span class="math inline">\(\beta_0\)</span> is the where the expected line interscepts the y-axis when <span class="math inline">\(x = 0\)</span>, the coefficient <span class="math inline">\(\beta_1\)</span> is the rate at which the <span class="math inline">\(y\)</span> (the results) changes <em>per unit change</em> in <span class="math inline">\(x\)</span> (the predictor, and <span class="math inline">\(\epsilon\)</span> is the left over variation (residual) that each point has.</p>
<p>The null hypothesis for this kind of regression model is</p>
<p><span class="math inline">\(H_O: \beta_1 = 0\)</span></p>
<p>We could have a hypothesis that <span class="math inline">\(\beta_0 = 0\)</span> but that is often not that interesting of an idea since that is a constant term in the equation (n.b., we could subtract it out from both sides). If we have more than one predictor variable, the null hypothesis becomes <span class="math inline">\(H_O: \beta_i = 0; \forall i\)</span> (that upside down triangle is ‘for all’).</p>
<p>Graphically, let us look at the following data as an example for basic regression models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">c</span>( <span class="fl">15.5</span>, <span class="fl">28.1</span>, <span class="fl">22.3</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                         <span class="fl">32.3</span>, <span class="fl">31.1</span>, <span class="fl">26.8</span>, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                         <span class="fl">41.8</span>, <span class="fl">30.3</span>, <span class="fl">47.9</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                         <span class="fl">41.1</span>) )</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( df, <span class="fu">aes</span>(x,y) ) <span class="sc">+</span> </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>( <span class="at">method=</span><span class="st">"lm"</span>, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula =</span> y <span class="sc">~</span> x, </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">se=</span><span class="cn">FALSE</span>, </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">"red"</span>, <span class="at">size=</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="regression_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The notion here is to be estimate the underlying formula for that red line that describes the variation in the original values in how <code>y</code> changes systematically across measured values of <code>x</code>.</p>
<section id="least-squares-fitting" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="least-squares-fitting"><span class="header-section-number">17.1</span> Least Squares Fitting</h2>
<p>So how do we figure this out? One of the most common ways is to uses a methods called <em>Least Squared Distance</em> fitting. To describe this, consider a set of hypothetical random models with random values estimated for both the intercept (<span class="math inline">\(\beta_0\)</span>) and slope (<span class="math inline">\(\beta_1\)</span>) coefficients. These <em>could be</em> close to a good models or not.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">beta0 =</span> <span class="fu">runif</span>(<span class="dv">250</span>,<span class="sc">-</span><span class="dv">20</span>,<span class="dv">40</span>),</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">beta1 =</span> <span class="fu">runif</span>(<span class="dv">250</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( models )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     beta0             beta1        
 Min.   :-19.995   Min.   :-4.9815  
 1st Qu.: -4.507   1st Qu.:-2.7747  
 Median : 13.686   Median :-0.5897  
 Mean   : 11.556   Mean   :-0.2112  
 3rd Qu.: 26.956   3rd Qu.: 2.3349  
 Max.   : 39.893   Max.   : 4.9967  </code></pre>
</div>
</div>
<p>We can plot these and the original data and all these randomly defined models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>( <span class="fu">aes</span>(<span class="at">intercept =</span> beta0, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">slope =</span> beta1), </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> models,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="fu">aes</span>(x,y), </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">data=</span>df )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A least squares fit is one that minimizes the distances of each point (in the y-axis) from the line created by the model. In the graph below, we can see this would be the distances (squared so we do not have positive and negative values) along the y-axis, between each point and the fitted line.</p>
<p>The “best model” here is one that minimizes the sum of squared distances distances.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Let’s look at those hypothetical models. I’m going to make a few little functions to help make the code look easy.</p>
<p>First, here is a function that returns the distances between the original points and a hypothesized regression line defined by an interscept and slope from the original points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>model_distance <span class="ot">&lt;-</span> <span class="cf">function</span>( interscept, slope, X, Y ) {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  yhat <span class="ot">&lt;-</span> interscept <span class="sc">+</span> slope <span class="sc">*</span> X</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  diff <span class="ot">&lt;-</span> Y <span class="sc">-</span> yhat</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">sqrt</span>( <span class="fu">mean</span>( diff <span class="sc">^</span> <span class="dv">2</span> ) ) )</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, let’s go through all the models and estimate the mean squared distances between the proposed line (from intercept and slope) and the original data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>models<span class="sc">$</span>dist <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(models) ) {</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  models<span class="sc">$</span>dist[i] <span class="ot">&lt;-</span> <span class="fu">model_distance</span>( models<span class="sc">$</span>beta0[i],</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                                    models<span class="sc">$</span>beta1[i],</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                                    df<span class="sc">$</span>x,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                                    df<span class="sc">$</span>y )</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>( models )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       beta0     beta1      dist
1  13.224649 -3.863088 44.206855
2  30.897552  4.279254 23.789143
3   6.626146  4.963379  8.798447
4  32.551256 -3.190101 24.204268
5  25.785952  4.362171 19.453256
6 -10.009928 -3.811105 65.569903</code></pre>
</div>
</div>
<p>If we look through these models, we can see which are better than others by sorting in increasing squared distance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()  <span class="sc">+</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>( <span class="fu">aes</span>(<span class="at">intercept =</span> beta0,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">slope =</span> beta1, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="sc">-</span>dist),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> <span class="fu">filter</span>( models, <span class="fu">rank</span>(dist) <span class="sc">&lt;=</span> <span class="dv">10</span> ),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="fu">aes</span>(x,y),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">data=</span>df) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>These models in the <em>parameter space</em> of intercepts and slopes can be visualized as this. These red-circles are close to where the best models are located.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( models, <span class="fu">aes</span>(<span class="at">x =</span> beta0, </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> beta1,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> <span class="sc">-</span>dist)) <span class="sc">+</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">data =</span> <span class="fu">filter</span>( models, <span class="fu">rank</span>(dist) <span class="sc">&lt;=</span> <span class="dv">10</span>), </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In addition to a random search, we can be a bit more systematic about it and make a grid of interscept and slope values, using a <em>grid search</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>( <span class="at">beta0 =</span> <span class="fu">seq</span>(<span class="dv">15</span>,<span class="dv">20</span>, <span class="at">length =</span> <span class="dv">25</span>),</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">beta1 =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="fl">3.5</span>, <span class="at">length =</span> <span class="dv">25</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">$</span>dist <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(grid) ) {</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  grid<span class="sc">$</span>dist[i] <span class="ot">&lt;-</span> <span class="fu">model_distance</span>( grid<span class="sc">$</span>beta0[i],</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                                  grid<span class="sc">$</span>beta1[i],</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                                  df<span class="sc">$</span>x,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                                  df<span class="sc">$</span>y )</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( grid, <span class="fu">aes</span>(<span class="at">x =</span> beta0, </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> beta1,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> <span class="sc">-</span>dist)) <span class="sc">+</span> </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">data =</span> <span class="fu">filter</span>( grid, <span class="fu">rank</span>(dist) <span class="sc">&lt;=</span> <span class="dv">10</span>), </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>You could imagine that we could iteratively soom in this grid and find the best fit combination of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> values until we converged on a really well fit set.</p>
<p>There is a more direct way to get to these results (though is much less pretty to look at) using the <code>lm()</code> linear models function.</p>
</section>
<section id="our-friend-lm" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="our-friend-lm"><span class="header-section-number">17.2</span> Our Friend <code>lm()</code></h2>
<p>To specify a potential model, we need to get the function the form we are interested in using.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>( y <span class="sc">~</span> x, <span class="at">data =</span> df )</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x, data = df)

Coefficients:
(Intercept)            x  
     17.280        2.625  </code></pre>
</div>
</div>
<p>We can see that for the values of the coefficients (labeled <em>Interscept</em> and <em>x</em>), it has a <code>model_distance()</code> of</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_distance</span>( <span class="sc">-</span><span class="fl">1.76</span>, <span class="fl">3.385</span>, df<span class="sc">$</span>x, df<span class="sc">$</span>y )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15.90948</code></pre>
</div>
</div>
<p>which we can see is pretty close in terms of the coefficients and has a smaller model distance than those examined in the grid.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>grid <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>( dist ) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>( <span class="at">n =</span> <span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     beta0 beta1     dist
1 17.29167 2.625 5.240071</code></pre>
</div>
</div>
<p>Fortunately, we have a lot of additional information available to us because we used the <code>lm()</code> function.</p>
</section>
<section id="model-fit" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="model-fit"><span class="header-section-number">17.3</span> Model Fit</h2>
<p>We can estimate a bunch of different models but before we look to see if it well behaved. There are several interesting plots that we can examine from the model object such as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( fit, <span class="at">which =</span> <span class="dv">1</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( fit, <span class="at">which =</span> <span class="dv">2</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( fit, <span class="at">which =</span> <span class="dv">5</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="analysis-of-variance-tables---decomposing-variation" class="level2" data-number="17.4">
<h2 data-number="17.4" class="anchored" data-anchor-id="analysis-of-variance-tables---decomposing-variation"><span class="header-section-number">17.4</span> Analysis of Variance Tables - Decomposing Variation</h2>
<p>Thus far, we’ve been able to estiamte a model, but is it one that explains a significant amount of variation? To determine this, we use the <em>analysis of variance table</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>( fit )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: y
          Df Sum Sq Mean Sq F value   Pr(&gt;F)   
x          1 568.67  568.67  16.568 0.003581 **
Residuals  8 274.58   34.32                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The terms in this table are:</p>
<ul>
<li><p>Degrees of Freedom (<em>df</em>): representing <code>1</code> degree of freedom for the model, and <code>N-1</code> for the residuals.</p></li>
<li><p>Sums of Squared Deviations:</p>
<ul>
<li><span class="math inline">\(SS_{Total} = \sum_{i=1}^N (y_i - \bar{y})^2\)</span></li>
<li><span class="math inline">\(SS_{Model} = \sum_{i=1}^N (\hat{y}_i - \bar{y})^2\)</span>, and</li>
<li><span class="math inline">\(SS_{Residual} = SS_{Total} - SS_{Model}\)</span></li>
</ul></li>
<li><p>Mean Squares (Standardization of the Sums of Squares for the degrees of freedom)</p>
<ul>
<li><span class="math inline">\(MS_{Model} = \frac{SS_{Model}}{df_{Model}}\)</span></li>
<li><span class="math inline">\(MS_{Residual} = \frac{SS_{Residual}}{df_{Residual}}\)</span></li>
</ul></li>
<li><p>The <span class="math inline">\(F\)</span>-statistic is from a known distribution and is defined by the ratio of Mean Squared values.</p></li>
<li><p><code>Pr(&gt;F)</code> is the probability associated the value of the <span class="math inline">\(F\)</span>-statistic and is dependent upon the degrees of freedom for the model and residuals.</p></li>
</ul>
</section>
<section id="variance-explained" class="level2" data-number="17.5">
<h2 data-number="17.5" class="anchored" data-anchor-id="variance-explained"><span class="header-section-number">17.5</span> Variance Explained</h2>
<p>There is a correlative measurement in regression models to the Pearson Product Moment Coefficient, (<span class="math inline">\(\rho\)</span>) in a statistic called <span class="math inline">\(R^2\)</span>. This parameter tells you, <em>How much of the observed variation in <code>y</code> is explained by the model?</em></p>
<p>The equation for <em>R^2</em> is:</p>
<p><span class="math display">\[
R^2 = \frac{SS_{Model}}{SS_{Total}}
\]</span></p>
<p>The value of this parameter is bound by 0 (the model explains no variation) and 1.0 (the model explains all the variation in the data). We can get to this and a few other parameters in the regression model by taking its summary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( fit )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.9836 -4.0182 -0.8709  5.3064  6.9909 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)   17.280      4.002   4.318  0.00255 **
x              2.626      0.645   4.070  0.00358 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.859 on 8 degrees of freedom
Multiple R-squared:  0.6744,    Adjusted R-squared:  0.6337 
F-statistic: 16.57 on 1 and 8 DF,  p-value: 0.003581</code></pre>
</div>
</div>
<p>Just like the model itself, the <code>summary.lm</code> object also has all these data contained within it in case you need to access them in textual format or to annotate graphical output.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>( <span class="fu">summary</span>( fit ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "call"          "terms"         "residuals"     "coefficients" 
 [5] "aliased"       "sigma"         "df"            "r.squared"    
 [9] "adj.r.squared" "fstatistic"    "cov.unscaled" </code></pre>
</div>
</div>
<p>Notice that the <code>p-value</code> is not in this list… It is estimable from the <code>fstatistic</code> and <code>df</code> values and here is a quick function that returns the raw p-value by looking up the are under the curve equal to or greater than the observed <code>fstatistic</code> with those degrees of freedom.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>get_pval <span class="ot">&lt;-</span> <span class="cf">function</span>( model ) {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="fu">summary</span>( model )<span class="sc">$</span>fstatistic[<span class="dv">1</span>]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  df1 <span class="ot">&lt;-</span> <span class="fu">summary</span>( model )<span class="sc">$</span>fstatistic[<span class="dv">2</span>]</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  df2 <span class="ot">&lt;-</span> <span class="fu">summary</span>( model )<span class="sc">$</span>fstatistic[<span class="dv">3</span>]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>( <span class="fl">1.0</span> <span class="sc">-</span> <span class="fu">pf</span>( f, df1, df2 ) )</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( p  )</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">get_pval</span>( fit )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0035813</code></pre>
</div>
</div>
<p>As an often-overlooked side effect, the <span class="math inline">\(R^2\)</span> from a simple one predictor regression model and the correlation coefficient <span class="math inline">\(r\)</span> from <code>cor.test(method='pearson')</code> are related as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>( <span class="st">`</span><span class="at">Regression R^2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">summary</span>( fit )<span class="sc">$</span>r.squared,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>   <span class="st">`</span><span class="at">Squared Correlation</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>( <span class="fu">cor.test</span>( df<span class="sc">$</span>x, df<span class="sc">$</span>y )<span class="sc">$</span>estimate<span class="sc">^</span><span class="dv">2</span> ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Regression R^2 Squared Correlation 
          0.6743782           0.6743782 </code></pre>
</div>
</div>
<p>(e.g., the square of the correlation estimate <span class="math inline">\(r\)</span> is equal to <span class="math inline">\(R^2\)</span>).</p>
</section>
<section id="extensions-of-the-model" class="level2" data-number="17.6">
<h2 data-number="17.6" class="anchored" data-anchor-id="extensions-of-the-model"><span class="header-section-number">17.6</span> Extensions of the Model</h2>
<p>There are several helper functions for dealing with regression models such as finding the predicted values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>( fit ) <span class="ot">-&gt;</span> yhat </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>yhat </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3        4        5        6        7        8 
19.90545 22.53091 25.15636 27.78182 30.40727 33.03273 35.65818 38.28364 
       9       10 
40.90909 43.53455 </code></pre>
</div>
</div>
<p>And we can plot it as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( yhat <span class="sc">~</span> df<span class="sc">$</span>x, <span class="at">type=</span><span class="st">'l'</span>, <span class="at">bty=</span><span class="st">"n"</span>, <span class="at">col=</span><span class="st">"red"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The residual values (e.g., the distance between the original data on the y-axis and the fitted regression model).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>( fit ) <span class="ot">-&gt;</span> resids</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>resids </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         1          2          3          4          5          6          7 
-4.4054545  5.5690909 -2.8563636  4.5181818  0.6927273 -6.2327273  6.1418182 
         8          9         10 
-7.9836364  6.9909091 -2.4345455 </code></pre>
</div>
</div>
<p>We almost <strong>always</strong> need to look at the residuals of a regression model to help diagnose any potential problems (as shown above in the plots of the raw model itself).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( resids <span class="sc">~</span> yhat, <span class="at">bty=</span><span class="st">"n"</span>, <span class="at">xlab=</span><span class="st">"Predicted Values"</span>, <span class="at">ylab=</span><span class="st">"Residuals (yhat - y)"</span>, <span class="at">pch=</span><span class="dv">16</span> )</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="comparing-models" class="level2" data-number="17.7">
<h2 data-number="17.7" class="anchored" data-anchor-id="comparing-models"><span class="header-section-number">17.7</span> Comparing Models</h2>
<p>OK, so we have a model that appears to suggest that the predicted values in <code>x</code> can explain the variation observed in <code>y</code>. Great. But, is this the best model or only one that is sufficiently <em>meh</em> such that we can reject the null hypothesis. How can we tell?</p>
<p>There are two parameters that we have already looked at that may help. These are:</p>
<ul>
<li><p>The <code>P-value</code>: Models with smaller probabilities could be considered more informative.</p></li>
<li><p>The <span class="math inline">\(R^2\)</span>: Models that explain more of the variation may be considered more informative.</p></li>
</ul>
<p>Let’s start by looking at some airquality data we have played with previously when working on <a href="https://dyerlab.github.io/ENVS-Lectures/r_language/data_frames/homework.nb.html">data.frame objects</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>( <span class="sc">-</span>Month, <span class="sc">-</span>Day ) <span class="ot">-&gt;</span> df.air</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( df.air )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Ozone           Solar.R           Wind             Temp      
 Min.   :  1.00   Min.   :  7.0   Min.   : 1.700   Min.   :56.00  
 1st Qu.: 18.00   1st Qu.:115.8   1st Qu.: 7.400   1st Qu.:72.00  
 Median : 31.50   Median :205.0   Median : 9.700   Median :79.00  
 Mean   : 42.13   Mean   :185.9   Mean   : 9.958   Mean   :77.88  
 3rd Qu.: 63.25   3rd Qu.:258.8   3rd Qu.:11.500   3rd Qu.:85.00  
 Max.   :168.00   Max.   :334.0   Max.   :20.700   Max.   :97.00  
 NA's   :37       NA's   :7                                       </code></pre>
</div>
</div>
<p>Let’s assume that we are interested in trying to explain the variation in <code>Ozone</code> (the response) by one or more of the other variables as predictors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>fit.solar <span class="ot">&lt;-</span> <span class="fu">lm</span>( Ozone <span class="sc">~</span> Solar.R, <span class="at">data =</span> df.air )</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>( fit.solar )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Ozone
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
Solar.R     1  14780 14779.7  15.053 0.0001793 ***
Residuals 109 107022   981.9                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Let’s look at all the predictors and take a look at both the <code>p-value</code> and <code>R-squared</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>fit.temp <span class="ot">&lt;-</span> <span class="fu">lm</span>( Ozone <span class="sc">~</span> Temp, <span class="at">data =</span> df.air )</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>fit.wind <span class="ot">&lt;-</span> <span class="fu">lm</span>( Ozone <span class="sc">~</span> Wind, <span class="at">data =</span> df.air )</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>( <span class="at">Model =</span> <span class="fu">c</span>( <span class="st">"Ozone ~ Solar"</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Ozone ~ Temp"</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Ozone ~ Wind"</span>), </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">R2 =</span> <span class="fu">c</span>( <span class="fu">summary</span>( fit.solar )<span class="sc">$</span>r.squared,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">summary</span>( fit.temp )<span class="sc">$</span>r.squared,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">summary</span>( fit.wind )<span class="sc">$</span>r.squared ), </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">P =</span> <span class="fu">c</span>( <span class="fu">get_pval</span>( fit.solar), </span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">get_pval</span>( fit.temp ),</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">get_pval</span>( fit.wind ) ) ) <span class="ot">-&gt;</span> df.models</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>df.models <span class="sc">%&gt;%</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>( <span class="sc">-</span>R2 ) <span class="sc">%&gt;%</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">P =</span> <span class="fu">format</span>( P, <span class="at">scientific=</span><span class="cn">TRUE</span>, <span class="at">digits=</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>( <span class="at">caption =</span> <span class="st">"Model parameters predicting mean ozone in parts per billion mresured in New York during the period of 1 May 2973 - 30 September 2973."</span>,</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-minimal table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Model parameters predicting mean ozone in parts per billion mresured in New York during the period of 1 May 2973 - 30 September 2973.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">R2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">P</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Temp</td>
<td style="text-align: right;">0.488</td>
<td style="text-align: left;">0.00e+00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Wind</td>
<td style="text-align: right;">0.362</td>
<td style="text-align: left;">9.27e-13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Solar</td>
<td style="text-align: right;">0.121</td>
<td style="text-align: left;">1.79e-04</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>So if we look at these results, we see that in both <span class="math inline">\(R^2\)</span> and <span class="math inline">\(P\)</span>, the model with <code>Temp</code> seems to be most explanatory as well as having the lowest probability. But is is significantly better?</p>
<p>How about if we start adding more than one variable to the equation so that we now have two variables (multiple regression) with the general model specified as:</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1 x_1 + beta_2 x_2 + \epsilon
\]</span></p>
<p>Now, we are estimating two regression coefficients and an interscept. For three predictors, this gives us 3 more models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>fit.temp.wind <span class="ot">&lt;-</span> <span class="fu">lm</span>( Ozone <span class="sc">~</span> Temp <span class="sc">+</span> Wind, <span class="at">data =</span> df.air )</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>fit.temp.solar <span class="ot">&lt;-</span> <span class="fu">lm</span>( Ozone <span class="sc">~</span> Temp <span class="sc">+</span> Solar.R, <span class="at">data =</span> df.air )</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>fit.wind.solar <span class="ot">&lt;-</span> <span class="fu">lm</span>( Ozone <span class="sc">~</span> Wind <span class="sc">+</span> Solar.R, <span class="at">data =</span> df.air )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we can add these output to the table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>df.models <span class="ot">&lt;-</span> <span class="fu">rbind</span>( df.models, </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">data.frame</span>( <span class="at">Model =</span> <span class="fu">c</span>( <span class="st">"Ozone ~ Temp + Wind"</span>,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"Ozone ~ Temp + Solar"</span>,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"Ozone ~ Wind + Solar"</span> ),</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">R2 =</span> <span class="fu">c</span>( <span class="fu">summary</span>( fit.temp.wind )<span class="sc">$</span>r.squared,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">summary</span>( fit.temp.solar )<span class="sc">$</span>r.squared,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">summary</span>( fit.wind.solar )<span class="sc">$</span>r.squared ),</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">P =</span> <span class="fu">c</span>( <span class="fu">get_pval</span>( fit.temp.wind),</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">get_pval</span>( fit.temp.solar),</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">get_pval</span>( fit.wind.solar) )</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>                                ))</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>df.models <span class="sc">%&gt;%</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">P =</span> <span class="fu">format</span>( P, <span class="at">scientific=</span><span class="cn">TRUE</span>, <span class="at">digits=</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>( <span class="at">caption =</span> <span class="st">"Model parameters predicting mean ozone in parts per billion mresured in New York during the period of 1 May 2973 - 30 September 2973."</span>,</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-minimal table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Model parameters predicting mean ozone in parts per billion mresured in New York during the period of 1 May 2973 - 30 September 2973.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">R2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">P</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Solar</td>
<td style="text-align: right;">0.121</td>
<td style="text-align: left;">1.79e-04</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Temp</td>
<td style="text-align: right;">0.488</td>
<td style="text-align: left;">0.00e+00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Wind</td>
<td style="text-align: right;">0.362</td>
<td style="text-align: left;">9.27e-13</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Temp + Wind</td>
<td style="text-align: right;">0.569</td>
<td style="text-align: left;">0.00e+00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Temp + Solar</td>
<td style="text-align: right;">0.510</td>
<td style="text-align: left;">0.00e+00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Wind + Solar</td>
<td style="text-align: right;">0.449</td>
<td style="text-align: left;">9.99e-15</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Hmmmmmm.</p>
<p>And for completeness, let’s just add the model that has all three predictors</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3 + \epsilon
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>fit.all <span class="ot">&lt;-</span> <span class="fu">lm</span>( Ozone <span class="sc">~</span> Solar.R <span class="sc">+</span> Temp <span class="sc">+</span> Wind, <span class="at">data =</span> df.air )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let’s add that one</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df.models <span class="ot">&lt;-</span> <span class="fu">rbind</span>( df.models, </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">data.frame</span>( <span class="at">Model =</span> <span class="fu">c</span>( <span class="st">"Ozone ~ Temp + Wind + Solar"</span>),</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">R2 =</span> <span class="fu">c</span>( <span class="fu">summary</span>( fit.all )<span class="sc">$</span>r.squared ),</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">P =</span> <span class="fu">c</span>( <span class="fu">get_pval</span>( fit.all)  )</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>                                ))</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>df.models<span class="sc">$</span>P <span class="ot">=</span> <span class="fu">cell_spec</span>( <span class="fu">format</span>( df.models<span class="sc">$</span>P, </span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">digits=</span><span class="dv">3</span>, </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">scientific=</span><span class="cn">TRUE</span>), </span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">color =</span> <span class="fu">ifelse</span>( df.models<span class="sc">$</span>P <span class="sc">==</span> <span class="fu">min</span>(df.models<span class="sc">$</span>P), </span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"red"</span>,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"black"</span>))</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>df.models<span class="sc">$</span>R2 <span class="ot">=</span> <span class="fu">cell_spec</span>( <span class="fu">format</span>( df.models<span class="sc">$</span>R2, </span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">digits=</span><span class="dv">3</span>, </span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">scientific=</span><span class="cn">TRUE</span>), </span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> <span class="fu">ifelse</span>( df.models<span class="sc">$</span>R2 <span class="sc">==</span> <span class="fu">max</span>( df.models<span class="sc">$</span>R2), </span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"green"</span>,</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"black"</span>))</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>df.models <span class="sc">%&gt;%</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">P =</span> <span class="fu">format</span>( P, <span class="at">digits=</span><span class="dv">3</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>( <span class="at">caption =</span> <span class="st">"Model parameters predicting mean ozone in parts per billion mresured in New York during the period of 1 May 2973 - 30 September 2973.  Values in green indicate the model with the largest variance explained and those in red indicate models with the lowest probability."</span>,</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>( <span class="st">"striped"</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-paper lightable-striped table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Model parameters predicting mean ozone in parts per billion mresured in New York during the period of 1 May 2973 - 30 September 2973. Values in green indicate the model with the largest variance explained and those in red indicate models with the lowest probability.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">R2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">P</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Solar</td>
<td style="text-align: left;"><span style="     color: black !important;">1.21e-01</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.79e-04</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Temp</td>
<td style="text-align: left;"><span style="     color: black !important;">4.88e-01</span></td>
<td style="text-align: left;"><span style="     color: red !important;">0.00e+00</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Wind</td>
<td style="text-align: left;"><span style="     color: black !important;">3.62e-01</span></td>
<td style="text-align: left;"><span style="     color: black !important;">9.27e-13</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Temp + Wind</td>
<td style="text-align: left;"><span style="     color: black !important;">5.69e-01</span></td>
<td style="text-align: left;"><span style="     color: red !important;">0.00e+00</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Temp + Solar</td>
<td style="text-align: left;"><span style="     color: black !important;">5.10e-01</span></td>
<td style="text-align: left;"><span style="     color: red !important;">0.00e+00</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Wind + Solar</td>
<td style="text-align: left;"><span style="     color: black !important;">4.49e-01</span></td>
<td style="text-align: left;"><span style="     color: black !important;">9.99e-15</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Temp + Wind + Solar</td>
<td style="text-align: left;"><span style="     color: green !important;">6.06e-01</span></td>
<td style="text-align: left;"><span style="     color: red !important;">0.00e+00</span></td>
</tr>
</tbody>
</table>


</div>
</div>
<p>So how do we figure out which one is best?</p>
<section id="effects-of-adding-parameters" class="level3" data-number="17.7.1">
<h3 data-number="17.7.1" class="anchored" data-anchor-id="effects-of-adding-parameters"><span class="header-section-number">17.7.1</span> Effects of Adding Parameters</h3>
<p>Before we can answer this, we should be clear about one thing. We are getting more variance explained by adding more predictor variables. In fact, by adding any variable, whether they are informative or not, one can explain some amount of the Sums of Squares in a model. Taken to the extreme, this means that we could add an infinite number of explanatory variables to a model and explain all the variation there is!</p>
<p>Here is an example using our small data set. I’m going to make several models, one of which is the original one and the remaining add one more predeictor varible that is made up of a random variables. We will then look at the <span class="math inline">\(R^2\)</span> of each of these models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>random.models  <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>random.models[[<span class="st">"Ozone ~ Temp"</span>]] <span class="ot">&lt;-</span> fit.temp</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>random.models[[<span class="st">"Ozone ~ Wind"</span>]] <span class="ot">&lt;-</span> fit.wind</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>random.models[[<span class="st">"Ozone ~ Solar"</span>]] <span class="ot">&lt;-</span> fit.solar</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>random.models[[<span class="st">"Ozone ~ Temp + Wind"</span>]] <span class="ot">&lt;-</span> fit.temp.wind</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>random.models[[<span class="st">"Ozone ~ Temp + Solar"</span>]] <span class="ot">&lt;-</span> fit.temp.solar</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>random.models[[<span class="st">"Ozone ~ Wind + Solar"</span>]] <span class="ot">&lt;-</span> fit.wind.solar</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>random.models[[ <span class="st">"Ozone ~ Temp + Wind + Solar"</span> ]] <span class="ot">&lt;-</span> fit.all</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>df.tmp <span class="ot">&lt;-</span> df.air</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span> ) {</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  lbl <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Ozone ~ Temp + Wind + Solar + "</span>, i, <span class="st">" Random Variables"</span>, <span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  df.tmp[[lbl]] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>( <span class="fu">nrow</span>(df.tmp) )</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  random.models[[lbl]] <span class="ot">&lt;-</span> <span class="fu">lm</span>( Ozone <span class="sc">~</span> ., <span class="at">data =</span> df.tmp ) </span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>( <span class="at">Models =</span> <span class="fu">names</span>( random.models ),</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">R2 =</span> <span class="fu">sapply</span>( random.models, </span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>                          <span class="at">FUN =</span> <span class="cf">function</span>( x ) <span class="fu">return</span>( <span class="fu">summary</span>( x )<span class="sc">$</span>r.squared), </span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>                          <span class="at">simplify =</span> <span class="cn">TRUE</span> ),</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">P =</span> <span class="fu">sapply</span>( random.models, </span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">FUN =</span> get_pval ) ) <span class="ot">-&gt;</span> df.random</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>df.random <span class="sc">%&gt;%</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>( <span class="at">caption =</span> <span class="st">"Fraction of variation explained by original variable as well as models with incrementally more predictor variables made up of randomly derived data."</span>,</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">digits=</span><span class="dv">4</span>,</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">row.names =</span> <span class="cn">FALSE</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>(<span class="st">"striped"</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-paper lightable-striped table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Fraction of variation explained by original variable as well as models with incrementally more predictor variables made up of randomly derived data.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Models</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">R2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">P</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Temp</td>
<td style="text-align: right;">0.4877</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Wind</td>
<td style="text-align: right;">0.3619</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Solar</td>
<td style="text-align: right;">0.1213</td>
<td style="text-align: right;">2e-04</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Temp + Wind</td>
<td style="text-align: right;">0.5687</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Temp + Solar</td>
<td style="text-align: right;">0.5103</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Wind + Solar</td>
<td style="text-align: right;">0.4495</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Temp + Wind + Solar</td>
<td style="text-align: right;">0.6059</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Temp + Wind + Solar + 1 Random Variables</td>
<td style="text-align: right;">0.6079</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Temp + Wind + Solar + 2 Random Variables</td>
<td style="text-align: right;">0.6231</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Temp + Wind + Solar + 3 Random Variables</td>
<td style="text-align: right;">0.6252</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Temp + Wind + Solar + 4 Random Variables</td>
<td style="text-align: right;">0.6323</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Temp + Wind + Solar + 5 Random Variables</td>
<td style="text-align: right;">0.6324</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Temp + Wind + Solar + 6 Random Variables</td>
<td style="text-align: right;">0.6324</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Temp + Wind + Solar + 7 Random Variables</td>
<td style="text-align: right;">0.6502</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Temp + Wind + Solar + 8 Random Variables</td>
<td style="text-align: right;">0.6578</td>
<td style="text-align: right;">0e+00</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>So if we just add random data to a model, we get a better fit!!!! Sounds great. That is easy! I can <strong>always</strong> get the best fit there is!</p>
<p>This is a well-known situation in statistics. An in fact, we must be very careful when we are examining the differences between models and attempting to decide which set of models are actually better than other sets of models.</p>
</section>
</section>
<section id="model-fitting" class="level2" data-number="17.8">
<h2 data-number="17.8" class="anchored" data-anchor-id="model-fitting"><span class="header-section-number">17.8</span> Model Fitting</h2>
<p>To get around this, we have a few tools at our disposal. The most common approach is to look at the <em>information content</em> in each model relative to the amount of pedictor variables. In essence, we must <em>punish</em> ourselves for adding more predictors so that we do not all run around and add random data to our models. The most common one is called Akaike Information Criterion (AIC), and provide a general framework for comparing several models.</p>
<p><span class="math display">\[
AIC = -2 \ln L + 2p
\]</span></p>
<p>Where <span class="math inline">\(L\)</span> is the log likelihood estimate of the variance and <span class="math inline">\(p\)</span> is the number of parameters. What this does is allow you to evaluate different models with different subsets of parameters. In general, the best model is the one with the smallest value for <code>AIC</code>.</p>
<p>We can also evaluate the relative values of all the models by looking in the difference between the “best” model and the rest by taking the difference</p>
<p><span class="math display">\[
\delta AIC = AIC - min(AIC)
\]</span></p>
<p>The prevailing notion is that models that have <span class="math inline">\(\delta AIC &lt; 2.0\)</span> should be considered as almost equally informative, where as those whose <span class="math inline">\(\delta AIC &gt; 5.0\)</span> are to be rejected as being informative. That <span class="math inline">\(2.0 \le \delta AIC \le 5.0\)</span> range is where it gets a bit fuzzy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>df.random<span class="sc">$</span>AIC <span class="ot">&lt;-</span> <span class="fu">sapply</span>( random.models, </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">FUN =</span> AIC, </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">simplify =</span> <span class="cn">TRUE</span> )</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>df.random<span class="sc">$</span>deltaAIC <span class="ot">=</span> df.random<span class="sc">$</span>AIC <span class="sc">-</span> <span class="fu">min</span>( df.random<span class="sc">$</span>A)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>df.random <span class="sc">%&gt;%</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>( <span class="sc">-</span>P ) <span class="sc">%&gt;%</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>( <span class="at">caption =</span> <span class="st">"Model parameters predicting mean ozone in parts per billion mresured in New York during the period of 1 May 2973 - 30 September 2973 with variance explained, AIC, and ∂AIC for alternative models."</span>,</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">row.names =</span> <span class="cn">FALSE</span>, </span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>( <span class="st">"striped"</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-paper lightable-striped table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Model parameters predicting mean ozone in parts per billion mresured in New York during the period of 1 May 2973 - 30 September 2973 with variance explained, AIC, and ∂AIC for alternative models.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Models</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">R2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">deltaAIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Temp</td>
<td style="text-align: right;">0.488</td>
<td style="text-align: right;">1067.706</td>
<td style="text-align: right;">69.940</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Wind</td>
<td style="text-align: right;">0.362</td>
<td style="text-align: right;">1093.187</td>
<td style="text-align: right;">95.421</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Solar</td>
<td style="text-align: right;">0.121</td>
<td style="text-align: right;">1083.714</td>
<td style="text-align: right;">85.948</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Temp + Wind</td>
<td style="text-align: right;">0.569</td>
<td style="text-align: right;">1049.741</td>
<td style="text-align: right;">51.975</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Temp + Solar</td>
<td style="text-align: right;">0.510</td>
<td style="text-align: right;">1020.820</td>
<td style="text-align: right;">23.053</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Wind + Solar</td>
<td style="text-align: right;">0.449</td>
<td style="text-align: right;">1033.816</td>
<td style="text-align: right;">36.049</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Temp + Wind + Solar</td>
<td style="text-align: right;">0.606</td>
<td style="text-align: right;">998.717</td>
<td style="text-align: right;">0.951</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Temp + Wind + Solar + 1 Random Variables</td>
<td style="text-align: right;">0.608</td>
<td style="text-align: right;">1000.141</td>
<td style="text-align: right;">2.374</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Temp + Wind + Solar + 2 Random Variables</td>
<td style="text-align: right;">0.623</td>
<td style="text-align: right;">997.766</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Temp + Wind + Solar + 3 Random Variables</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">999.136</td>
<td style="text-align: right;">1.370</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Temp + Wind + Solar + 4 Random Variables</td>
<td style="text-align: right;">0.632</td>
<td style="text-align: right;">999.029</td>
<td style="text-align: right;">1.263</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Temp + Wind + Solar + 5 Random Variables</td>
<td style="text-align: right;">0.632</td>
<td style="text-align: right;">1001.000</td>
<td style="text-align: right;">3.233</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Temp + Wind + Solar + 6 Random Variables</td>
<td style="text-align: right;">0.632</td>
<td style="text-align: right;">1002.998</td>
<td style="text-align: right;">5.232</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ozone ~ Temp + Wind + Solar + 7 Random Variables</td>
<td style="text-align: right;">0.650</td>
<td style="text-align: right;">999.475</td>
<td style="text-align: right;">1.709</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ozone ~ Temp + Wind + Solar + 8 Random Variables</td>
<td style="text-align: right;">0.658</td>
<td style="text-align: right;">999.052</td>
<td style="text-align: right;">1.286</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>So as we look at the data here, we see that the best fit model is the full model though others may be considered as informative and this is where we need to look at the biological importance of variables added to the models.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./correlation.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Corelation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./anova.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>